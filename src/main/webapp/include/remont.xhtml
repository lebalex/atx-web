<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<p:panelGrid rendered="#{not empty quickSearch.selectedAvto}"
             styleClass="panelGridAvtoCard_bar_select_date">
    <p:row>
        <p:column style="white-space: nowrap;">
            <p:outputLabel value="Период"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:datePicker showIcon="true" size="10" showOn="button" value="#{quickSearch.selectedAvto.expl_date1}"
                        locale="ru" pattern="dd.MM.yyyy"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:datePicker showIcon="true" size="10" showOn="button" value="#{quickSearch.selectedAvto.expl_date2}"
                        locale="ru" pattern="dd.MM.yyyy"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:commandButton value="Показать" actionListener="#{quickSearch.getRemontCards}"
                             update=":form:tabview:remont_data"/>
        </p:column>
        <p:column style="text-align:right; width: 100%">
            <p:commandButton styleClass="p-mr-2" title="Добавить" icon="pi pi-plus"  actionListener="#{quickSearch.newRemontCards}"
                             oncomplete="PF('dlg_remont').show();" process="@this" update=":form:remontDetail"/>

            <p:commandButton title="Удалить" icon="fa fa-fw fa-trash" actionListener="#{quickSearch.deleteRemont}"
                             update=":form:tabview:remont_data :form:growlAvto">
                <p:confirm header="Подтверждение" message="Удалить выбранную запись?" icon="pi pi-info-circle" update=":form:tabview:remont_data :form:growlAvto"/>
            </p:commandButton>

        </p:column>
    </p:row>
</p:panelGrid>

<p:dataTable id="remont_data" var="remont" value="#{quickSearch.selectedAvto.listRemontModel}"
             selection="#{quickSearch.selectedAvto.selectedRemont}"
             rendered="#{not empty quickSearch.selectedAvto}"
             scrollable="true" scrollWidth="1300" scrollHeight="410" selectionMode="single"
             rowKey="#{remont.id}"
             emptyMessage="нет записей">
    <p:ajax listener="#{quickSearch.onSelectedRemont}" event="rowDblselect" oncomplete="PF('dlg_remont').show();" update=":form:remontDetail"/>
    <p:column headerText="№" width="20">
        <h:outputText value="#{remont.num}"/>
    </p:column>
    <p:column headerText="Дата начала" width="60">
        <h:outputText value="#{remont.date_begin}">
            <f:convertDateTime pattern="dd.MM.yyyy"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Дата окончания" width="60">
        <h:outputText value="#{remont.date_end}">
            <f:convertDateTime pattern="dd.MM.yyyy"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Вид ремонта" width="60">
        <h:outputText value="#{remont.name_vid}"/>
    </p:column>
    <p:column headerText="Сумма ремонта" width="60">
        <h:outputText value="#{remont.sum_remont1}">
        <f:convertNumber type="number" pattern="#.##"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Сумма запчастей" width="60">
        <h:outputText value="#{remont.sum_remont2}">
            <f:convertNumber type="number" pattern="#.##"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Сумма ТМЦ" width="60">
        <h:outputText value="#{remont.sum_remont3}">
            <f:convertNumber type="number" pattern="#.##"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Кол-во дней" width="50">
        <h:outputText value="#{remont.day_remont}"/>
    </p:column>
    <p:column headerText="Место ремонта" width="200">
        <h:outputText value="#{remont.name_place}"/>
    </p:column>
    <p:column headerText="Спидометр на начало работ" width="100">
        <h:outputText value="#{remont.speed_begin}">
            <f:convertNumber type="number" pattern="#"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Спидометр на следующее ТО" width="100">
        <h:outputText value="#{remont.speed_to}">
            <f:convertNumber type="number" pattern="#"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Масло(л)" width="50">
        <h:outputText value="#{remont.oil_l}">
            <f:convertNumber type="number" pattern="#"/>
        </h:outputText>
    </p:column>


</p:dataTable>


</html>