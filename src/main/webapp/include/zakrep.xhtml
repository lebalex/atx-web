<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<p:panelGrid rendered="#{not empty quickSearch.selectedAvto}"
             styleClass="panelGridAvtoCard_bar_select_date">
    <p:row>
        <p:column style="white-space: nowrap;">
            <p:outputLabel value="Период"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:calendar showOn="button" value="#{quickSearch.selectedAvto.expl_date1}"
                        locale="ru" pattern="dd.MM.yyyy"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:calendar showOn="button" value="#{quickSearch.selectedAvto.expl_date2}"
                        locale="ru" pattern="dd.MM.yyyy"/>
        </p:column>
        <p:column style="white-space: nowrap;">
            <p:commandButton value="Показать" actionListener="#{quickSearch.getZakrepCards}"
                             update=":form:tabview:zakrep_data"/>
        </p:column>
        <p:column style="text-align:right; width: 100%">
            <p:commandButton styleClass="p-mr-2" title="Добавить" icon="pi pi-plus"  actionListener="#{quickSearch.newZakrepCards}"
                             oncomplete="PF('dlg_zakrep').show();" process="@this" update=":form:zakrepDetail"/>
            <p:commandButton title="Справка" value="Справка (docx)" icon="pi pi-print"
                             styleClass="p-mr-2 ui-button-raised ui-button-success" actionListener="#{quickSearch.printZakrepSpravka}" ajax="false"/>
            <p:commandButton title="Карточка" value="Карточка (docx)" icon="pi pi-print"
                             styleClass="p-mr-2 ui-button-raised ui-button-success" actionListener="#{quickSearch.printZakrepCard}" ajax="false"/>

            <p:commandButton title="Удалить" icon="fa fa-fw fa-trash" actionListener="#{quickSearch.deleteZakrepCards}"
                             update=":form:tabview:zakrep_data :form:growlAvto">
            <p:confirm header="Подтверждение" message="Удалить выбранную запись?" icon="pi pi-info-circle" update=":form:tabview:zakrep_data :form:growlAvto"/>
            </p:commandButton>
        </p:column>
    </p:row>
</p:panelGrid>

<p:dataTable id="zakrep_data" var="zakrep" value="#{quickSearch.selectedAvto.listZakrepModel}"
             selection="#{quickSearch.selectedAvto.selectedZakrep}"
             rendered="#{not empty quickSearch.selectedAvto}"
             scrollable="true" scrollWidth="1300" scrollHeight="410" selectionMode="single"
             rowKey="#{zakrep.id}"
             emptyMessage="нет записей">
    <p:ajax listener="#{quickSearch.onSelectedZakrep}" event="rowDblselect" oncomplete="PF('dlg_zakrep').show();" update=":form:zakrepDetail"/>
    <p:column headerText="Дата закрепления" width="60">
        <h:outputText value="#{zakrep.date_begin}">
            <f:convertDateTime pattern="dd.MM.yyyy"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Дата окончания" width="60">
        <h:outputText value="#{zakrep.date_end}">
            <f:convertDateTime pattern="dd.MM.yyyy"/>
        </h:outputText>
    </p:column>
    <p:column headerText="Приказ" width="60">
        <h:outputText value="#{zakrep.prikaz}"/>
    </p:column>
    <p:column headerText="Дата приказа" width="60">
        <h:outputText value="#{zakrep.date_prikaz}">
            <f:convertDateTime pattern="dd.MM.yyyy"/>
        </h:outputText>
    </p:column>
    <p:column headerText="ФИО" width="100">
        <h:outputText value="#{zakrep.fio}"/>
    </p:column>
    <p:column headerText="Должность" width="100">
        <h:outputText value="#{zakrep.dolg}"/>
    </p:column>
    <p:column headerText="Звание" width="100">
        <h:outputText value="#{zakrep.zvan}"/>
    </p:column>




</p:dataTable>


</html>